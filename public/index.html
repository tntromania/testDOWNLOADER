<!DOCTYPE html>
<html lang="ro">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>YouTube Downloader & Transcript</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      text-align: center;
      padding: 20px;
    }
    input, button {
      margin: 10px;
      padding: 10px;
    }
    .results {
      margin-top: 20px;
    }
  </style>
</head>
<body>
  <h1>YouTube Downloader & Translator</h1>
  <p>Introduceți link-ul complet al unui video YouTube pentru a descărca și a obține transcriptul tradus automat.</p>

  <input type="text" id="youtubeUrl" placeholder="Pastează URL-ul YouTube..." />
  <button onclick="downloadAndFetchTranscript()">Descarcă Video</button>

  <div class="results" id="results" style="display: none;">
    <h3>Rezultate:</h3>
    <p><strong>Transcript original:</strong></p>
    <pre id="originalTranscript"></pre>
    <p><strong>Transcript tradus:</strong></p>
    <pre id="translatedTranscript"></pre>
  </div>

  <script>
    async function downloadAndFetchTranscript() {
      const url = document.getElementById("youtubeUrl").value.trim();
      if (!url) {
        alert("Introduceți un URL valid!");
        return;
      }

      try {
        const response = await fetch("/api/download", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ url }),
        });

        if (!response.ok) {
          alert("Descărcarea a eșuat!");
          return;
        }

        const originalTranscript = response.headers.get("x-transcript-original");
        const translatedTranscript = response.headers.get(
          "x-transcript-translated"
        );

        document.getElementById("results").style.display = "block";
        document.getElementById("originalTranscript").textContent =
          originalTranscript || "N/A";
        document.getElementById("translatedTranscript").textContent =
          translatedTranscript || "Fără traducere";

        window.open(response.url, "_blank");
      } catch (err) {
        console.error("Eroare la descărcare:", err);
        alert("A apărut o eroare la procesare.");
      }
    }
  </script>
</body>
</html>